<div class="flex flex-col items-center w-full max-w-md mx-auto space-y-4 p-4 ">
  <!-- Main Ticket List Card -->
  <div class="bg-grey-100 rounded-xl shadow-lg text-center p-2">

    <!-- falseWindow: shows Ticket Form -->
    @if (showInput) {
      <form class="mt-4 p-2 bg-gray-50 rounded-lg">
        <textarea [(ngModel)]="newTicketTitle"
                  name="ticketTitle"
                  placeholder="Enter your ticket"
                  class="border p-2 rounded w-full h-24 mb-2">
        </textarea>

        <button type="button"
                (click)="submitNewTicket()"
                class="px-4 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">
          Confirm
        </button>
      </form>
    }

    <!-- create ticket Buttons -->
    <ul class="flex flex-row gap-5 justify-center my-2">
      <li class="flex items-center justify-center gap-2 cursor-pointer"
          (click)="createTicket()">
        <span class="text-blue-500">‚ûï</span> Create Ticket
      </li>
    </ul>
</div>

  <!-- Individual Ticket Cards -->
  @for (ticket of filteredTickets; track ticket.id) {
    <div class="bg-white text-black p-4 rounded-xl shadow-lg w-full text-center">
      <div class = "text-bold text-lg">
        {{ ticket.id }} | {{ ticket.title }}
      </div>

      <!-- falseWindow: Move Ticket Options -->
      @if (moveInput && selectedTicketId === ticket.id) {
        <div class="mt-4 p-4 border-2 rounded-lg">
          <h3 class="text-sm font-semibold mb-2">Moving to...</h3>

          <select [(ngModel)]="ticketStatus"
            name="ticketStatus"
            class="block w-full appearance-none border border-gray-300 px-3 py-2 rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500">
            <option value="" disabled selected>Select status</option>
            <option value="todo"> Todo</option>
            <option value="in-progress"> In Progress</option>
            <option value="resolved"> Resolved</option>
          </select>

          <button (click)="confirmMoveTicket()"
                  class="p-2 bg-blue-400 text-white rounded hover:bg-blue-200">
            Confirm
          </button> 
        </div>
      }

      @if (selectedAssignTicketId === ticket.id){
        <div class="mt-4 p-4 bg-gray-50 rounded-lg">
          <h3 class="text-lg font-semibold mb-2 bg-green-300 rounded">Assigning to...</h3>
          <select [(ngModel)]="assignedUserId"
                  name="assignedUserId"
                  class="border p-2 rounded w-full mb-2">
            <option value="">Choose to assign</option>
            <option *ngFor="let user of users" [value]="user.id">
              {{ user.name }} - {{ user.email }}
            </option>
          </select>
          <button (click)="confirmAssign()"
                  class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
            Assign
          </button>
        </div>
      }


      <!-- falseWindow: Buttons after creation-->
      <ul class="flex flex-row gap-5 justify-center mt-6 pt-4 border-t">
        <li class="flex items-center justify-center gap-2 cursor-pointer hover:opacity-80"
            (click)="moveTicket(ticket.id)">
          <span class="text-orange-600">‚û°Ô∏è</span> Move
        </li>

        <!--
        <li class="flex items-center justify-center gap-2 cursor-pointer hover:opacity-80">
          <span class="text-green-600">üìã</span> List
        </li>
        -->
        
        <li class="flex items-center justify-center gap-2 cursor-pointer hover:opacity-80"
            (click)="createAssign(ticket.id)">
          <span class="text-green-600">üë§</span> Assign
        </li>

         <!-- ‚úÖ Compact version -->
          <!-- ‚úÖ Display Assigned User Info -->
<!-- ‚úÖ Compact version -->
@if (ticket.assigned_to) {
  <div class="mt-2 px-3 py-1 bg-green-50 border-l-4 border-green-500 rounded">
    <span class="text-xs text-green-700">
      üë§ <span class="font-semibold">{{ getAssignedUserName(ticket.assigned_to) }}</span>
    </span>
  </div>
} @else {
  <div class="mt-2 px-3 py-1 bg-gray-50 border-gray-300 rounded">
    <span class="text-xs text-gray-400 italic">Unassigned</span>
  </div>
}
      </ul>
    </div>
  }
</div>
